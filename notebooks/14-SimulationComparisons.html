
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulation Comparisons &#8212; Aperiodic  Methods</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >let toggleHintShow = 'Click to show';</script>
    <script >let toggleHintHide = 'Click to hide';</script>
    <script >let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Power Spectrum Simulations" href="15-PowerSpectrumSimulations.html" />
    <link rel="prev" title="Simulation Tests" href="13-SimulationTests.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Aperiodic  Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00-Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01-Outline.html">
   Outline
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Simulations
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="10-Simulations.html">
   Simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11-TimeDomainSimulations.html">
   Time Series Simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-TimeSimsParameters.html">
   Time Domain Simulation Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-SimulationTests.html">
   Simulation Tests
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Simulation Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-PowerSpectrumSimulations.html">
   Power Spectrum Simulations
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Time Domain Method Evaluations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="20-TimeDomainMethods.html">
   Time Domain Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="21-AutoCorrelation.html">
   AutoCorrelation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22-Fluctuations.html">
   Fluctuation Analyses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22B-Fluctuations-Multiscale.html">
   Fluctuations (Multiscale)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="23-FractalDimension.html">
   Fractal Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="23B-Fractal-State.html">
   Fractal Dimension (State Space)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="24-Complexity.html">
   Complexity Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="24B-Complexity-State.html">
   Complexity (State Space)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="25-Entropy.html">
   Information Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="25B-Entropy-Multiscale.html">
   Multiscale Entropy
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Spectral Method Evaluations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="30-SpectralMethods.html">
   Spectral Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="31-SpectralFitting.html">
   Spectral Fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="33-IRASA.html">
   IRASA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="34-ExponentComparisons.html">
   Exponent Comparisons
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Method Comparisons
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="40-MethodComparisons.html">
   Method Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="41-WithinComparisons.html">
   Within Method Type Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="42-BetweenComparisons.html">
   Between Method Type Comparisons
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="50-DataComparisons.html">
   Data Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="51-RestingEEGData.html">
   Resting EEG Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="52-DevelopmentalEEGData.html">
   Developmental EEG Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="53-iEEGData.html">
   iEEG Data
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/14-SimulationComparisons.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/aperiodicmethods//master?urlpath=tree/apmethods/notebooks/14-SimulationComparisons.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#settings">
   Settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulations">
   Simulations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sample-simulations">
     Sample Simulations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-signals-aperiodic">
       Example signals - aperiodic
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simsamplers">
     SimSamplers
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-signals-combined">
       Example signals - combined
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-example-power-spectra">
     Plot Example Power Spectra
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code-approach-run-comparisons">
   Code Approach:
   <code class="docutils literal notranslate">
    <span class="pre">
     run_comparisons
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-simulations-across-variations-in-exponent">
     Run simulations across variations in exponent
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-simulations-across-variations-in-multiple-parameters">
     Run simulations across variations in multiple parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluating-results">
     Evaluating Results
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Simulation Comparisons</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#settings">
   Settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulations">
   Simulations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sample-simulations">
     Sample Simulations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-signals-aperiodic">
       Example signals - aperiodic
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simsamplers">
     SimSamplers
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-signals-combined">
       Example signals - combined
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-example-power-spectra">
     Plot Example Power Spectra
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code-approach-run-comparisons">
   Code Approach:
   <code class="docutils literal notranslate">
    <span class="pre">
     run_comparisons
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-simulations-across-variations-in-exponent">
     Run simulations across variations in exponent
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-simulations-across-variations-in-multiple-parameters">
     Run simulations across variations in multiple parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluating-results">
     Evaluating Results
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="simulation-comparisons">
<h1>Simulation Comparisons<a class="headerlink" href="#simulation-comparisons" title="Permalink to this headline">¶</a></h1>
<p>This notebook introduces how this prokect compares the different methods using simulations.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A key question for interpreting prior work is to consider how the different employed methods relate to each other. To investigate this, this project uses simulated data and applies different methods to compare their results.</p>
<p>In this section, the main question is the evaluate the relationship between different methods across parameters variations, to evaluate which methods are highly correlated (suggesting they reflect the same properties in the data), and which appear to be more independent (suggesting they reflect different properties in the data).</p>
<p>Note that due to large number of possible comparisons across different methods and different simulated parameters, in this section we necessarily restrict the comparison to a selected subset of methods, that are compared pairwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">fooof.plts</span> <span class="kn">import</span> <span class="n">plot_spectra</span>

<span class="kn">from</span> <span class="nn">neurodsp.spectral</span> <span class="kn">import</span> <span class="n">compute_spectrum</span>
<span class="kn">from</span> <span class="nn">neurodsp.spectral.utils</span> <span class="kn">import</span> <span class="n">trim_spectrum</span>
<span class="kn">from</span> <span class="nn">neurodsp.sim</span> <span class="kn">import</span> <span class="n">sim_powerlaw</span><span class="p">,</span> <span class="n">sim_combined</span>
<span class="kn">from</span> <span class="nn">neurodsp.utils</span> <span class="kn">import</span> <span class="n">create_times</span><span class="p">,</span> <span class="n">set_random_seed</span>
<span class="kn">from</span> <span class="nn">neurodsp.plts.combined</span> <span class="kn">import</span> <span class="n">plot_timeseries_and_spectra</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/59/8y2d5r257c77vzymnqs47x080000gn/T/ipykernel_21418/680240959.py:3: DeprecationWarning: 
The `fooof` package is being deprecated and replaced by the `specparam` (spectral parameterization) package.
This version of `fooof` (1.1) is fully functional, but will not be further updated.
New projects are recommended to update to using `specparam` (see Changelog for details).
  from fooof.plts import plot_spectra
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the `run_comparisons` function from the custom code folder</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span> <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>

<span class="kn">from</span> <span class="nn">apm.io</span> <span class="kn">import</span> <span class="n">APMDB</span>
<span class="kn">from</span> <span class="nn">apm.run</span> <span class="kn">import</span> <span class="n">run_comparisons</span>
<span class="kn">from</span> <span class="nn">apm.analysis</span> <span class="kn">import</span> <span class="n">compute_all_corrs</span>
<span class="kn">from</span> <span class="nn">apm.plts</span> <span class="kn">import</span> <span class="n">plot_dots</span>
<span class="kn">from</span> <span class="nn">apm.plts.utils</span> <span class="kn">import</span> <span class="n">figsaver</span>
<span class="kn">from</span> <span class="nn">apm.plts.settings</span> <span class="kn">import</span> <span class="n">COLORS</span>
<span class="kn">from</span> <span class="nn">apm.sim.sim</span> <span class="kn">import</span> <span class="n">sig_sampler</span>
<span class="kn">from</span> <span class="nn">apm.sim.update</span> <span class="kn">import</span> <span class="n">create_updater</span><span class="p">,</span> <span class="n">create_sampler</span><span class="p">,</span> <span class="n">param_sampler</span>
<span class="kn">from</span> <span class="nn">apm.sim.defs</span> <span class="kn">import</span> <span class="n">SIM_SAMPLERS</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set plot style</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="settings">
<h2>Settings<a class="headerlink" href="#settings" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for saving figures</span>
<span class="n">SAVE_FIG</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">FIGPATH</span> <span class="o">=</span> <span class="n">APMDB</span><span class="p">()</span><span class="o">.</span><span class="n">figs_path</span> <span class="o">/</span> <span class="s1">&#39;14_sim_comps&#39;</span>

<span class="c1"># Create helper function to manage figsaver settings</span>
<span class="n">fsaver</span> <span class="o">=</span> <span class="n">figsaver</span><span class="p">(</span><span class="n">SAVE_FIG</span><span class="p">,</span> <span class="n">FIGPATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed</span>
<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="simulations">
<h2>Simulations<a class="headerlink" href="#simulations" title="Permalink to this headline">¶</a></h2>
<p>In this section, we will use simulated data to compare methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a times vector for time series</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">create_times</span><span class="p">(</span><span class="o">**</span><span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define general settings for creating simulations</span>
<span class="n">N_SIMS</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">RETURN_PARAMS</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sample-simulations">
<h3>Sample Simulations<a class="headerlink" href="#sample-simulations" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define ranges to sample parameters from</span>
<span class="n">samplers_ap</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">create_updater</span><span class="p">(</span><span class="s1">&#39;exponent&#39;</span><span class="p">)</span> <span class="p">:</span> <span class="n">create_sampler</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a parameter sampler</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">param_sampler</span><span class="p">(</span><span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ap&#39;</span><span class="p">],</span> <span class="n">samplers_ap</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check example sampled parameters</span>
<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">sampler</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;n_seconds&#39;: 30, &#39;fs&#39;: 250, &#39;exponent&#39;: -0.5, &#39;f_range&#39;: (0.5, None)}
{&#39;n_seconds&#39;: 30, &#39;fs&#39;: 250, &#39;exponent&#39;: -1.3, &#39;f_range&#39;: (0.5, None)}
{&#39;n_seconds&#39;: 30, &#39;fs&#39;: 250, &#39;exponent&#39;: -0.5, &#39;f_range&#39;: (0.5, None)}
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-signals-aperiodic">
<h4>Example signals - aperiodic<a class="headerlink" href="#example-signals-aperiodic" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize signal generator for aperiodic signals</span>
<span class="n">sig_gen_ap</span> <span class="o">=</span> <span class="n">sig_sampler</span><span class="p">(</span><span class="n">sim_powerlaw</span><span class="p">,</span> <span class="n">sampler</span><span class="p">,</span> <span class="n">RETURN_PARAMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot example generated signals</span>
<span class="k">for</span> <span class="n">cur_sig_ap</span><span class="p">,</span> <span class="n">cur_params_ap</span> <span class="ow">in</span> <span class="n">sig_gen_ap</span><span class="p">:</span>
    <span class="n">plot_timeseries_and_spectra</span><span class="p">(</span><span class="n">cur_sig_ap</span><span class="p">,</span> <span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">ts_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
                                <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Exponent: </span><span class="si">{:1.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cur_params_ap</span><span class="p">[</span><span class="s1">&#39;exponent&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14-SimulationComparisons_17_0.png" src="../_images/14-SimulationComparisons_17_0.png" />
<img alt="../_images/14-SimulationComparisons_17_1.png" src="../_images/14-SimulationComparisons_17_1.png" />
<img alt="../_images/14-SimulationComparisons_17_2.png" src="../_images/14-SimulationComparisons_17_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="simsamplers">
<h3>SimSamplers<a class="headerlink" href="#simsamplers" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check pre-defined samplers available in imported object</span>
<span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;exp_sampler&#39;,
 &#39;tscale_sampler&#39;,
 &#39;knee_sampler&#39;,
 &#39;comb_sampler&#39;,
 &#39;peak_sampler&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset number of samples</span>
<span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-signals-combined">
<h4>Example signals - combined<a class="headerlink" href="#example-signals-combined" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize signal generator for aperiodic signals</span>
<span class="n">sig_gen_comb</span> <span class="o">=</span> <span class="n">sig_sampler</span><span class="p">(</span><span class="n">sim_combined</span><span class="p">,</span> <span class="n">SIM_SAMPLERS</span><span class="p">[</span><span class="s1">&#39;comb_sampler&#39;</span><span class="p">],</span> <span class="n">RETURN_PARAMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot example generated signals</span>
<span class="k">for</span> <span class="n">cur_sig_comb</span><span class="p">,</span> <span class="n">cur_params_comb</span> <span class="ow">in</span> <span class="n">sig_gen_comb</span><span class="p">:</span>
    <span class="n">plot_timeseries_and_spectra</span><span class="p">(</span><span class="n">cur_sig_comb</span><span class="p">,</span> <span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">ts_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
                                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Exp : </span><span class="si">{:1.2f}</span><span class="s1">,  CF: </span><span class="si">{:2.0f}</span><span class="s1">,  PW: </span><span class="si">{:1.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
                                    <span class="n">cur_params_comb</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">][</span><span class="s1">&#39;sim_powerlaw&#39;</span><span class="p">][</span><span class="s1">&#39;exponent&#39;</span><span class="p">],</span> 
                                    <span class="n">cur_params_comb</span><span class="p">[</span><span class="s1">&#39;components&#39;</span><span class="p">][</span><span class="s1">&#39;sim_oscillation&#39;</span><span class="p">][</span><span class="s1">&#39;freq&#39;</span><span class="p">],</span> 
                                    <span class="n">cur_params_comb</span><span class="p">[</span><span class="s1">&#39;component_variances&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14-SimulationComparisons_23_0.png" src="../_images/14-SimulationComparisons_23_0.png" />
<img alt="../_images/14-SimulationComparisons_23_1.png" src="../_images/14-SimulationComparisons_23_1.png" />
<img alt="../_images/14-SimulationComparisons_23_2.png" src="../_images/14-SimulationComparisons_23_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="plot-example-power-spectra">
<h3>Plot Example Power Spectra<a class="headerlink" href="#plot-example-power-spectra" title="Permalink to this headline">¶</a></h3>
<p>Here we compute and plot power spectra of example sampled simulations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset random seed</span>
<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">88</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reinitialize signal generator for aperiodic signals</span>
<span class="n">sig_gen_comb</span> <span class="o">=</span> <span class="n">sig_sampler</span><span class="p">(</span><span class="n">sim_combined</span><span class="p">,</span> <span class="n">SIM_SAMPLERS</span><span class="p">[</span><span class="s1">&#39;comb_sampler&#39;</span><span class="p">],</span> <span class="n">RETURN_PARAMS</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute and collect power spectra of some sampled simulations</span>
<span class="n">psds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">tsig</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sig_gen_comb</span><span class="p">:</span>
    <span class="n">freqs</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">trim_spectrum</span><span class="p">(</span><span class="o">*</span><span class="n">compute_spectrum</span><span class="p">(</span><span class="n">tsig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">nperseg</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
    <span class="n">psds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">psd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the collection of computed power spectra of the simulations</span>
<span class="n">plot_spectra</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psds</span><span class="p">,</span> <span class="n">log_freqs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log_powers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;psds&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14-SimulationComparisons_28_0.png" src="../_images/14-SimulationComparisons_28_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="code-approach-run-comparisons">
<h2>Code Approach: <code class="docutils literal notranslate"><span class="pre">run_comparisons</span></code><a class="headerlink" href="#code-approach-run-comparisons" title="Permalink to this headline">¶</a></h2>
<p>Here, we will briefly introduce the general strategy and code used to run the method comparisons on simulations.</p>
<p>The overarching function used to run simulation comparisons is the <code class="docutils literal notranslate"><span class="pre">run_comparisons</span></code> function.</p>
<p>This approach allows for:</p>
<ul class="simple">
<li><p>defining a procedure to simulate time series</p></li>
<li><p>defining a set of measures to apply to the simulated time series</p></li>
<li><p>applying the set of measures across simulated instances, sampling from parameter ranges</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the documentation for `run_comparisons`</span>
<span class="nb">print</span><span class="p">(</span><span class="n">run_comparisons</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Compute multiple measures of interest across the same set of simulations.

    Parameters
    ----------
    sim_func : callable
        A function to create simulated time series.
    sim_params : iterable or list of dict
        Simulation parameters for `sim_func`.
    measures : dict
        Functions to apply to the simulated data.
        The keys should be functions to apply to the data.
        The values should be a dictionary of parameters to use for the method.
    n_sims : int, optional
        The number of simulations to run.
    return_params : bool, default: False
        Whether to collect and return the parameters of all the generated simulations.
    verbose : bool, optional, default: False
        Whether to print out simulation parameters.
        Used for checking simulations / debugging.
    warnings_action : {&#39;ignore&#39;, &#39;error&#39;, &#39;always&#39;, &#39;default&#39;, &#39;module, &#39;once&#39;}
        Filter action for warnings.

    Returns
    -------
    results : dict
        Computed results for each measure across the set of simulated data.
    all_sim_params : pd.DataFrame
        Collected simulation parameters across all the simulations.
        Only returned if `return_params` is True.
    
</pre></div>
</div>
</div>
</div>
<p>Next, we can run an example of using <code class="docutils literal notranslate"><span class="pre">run_comparisons</span></code>.</p>
<p>To do so, we will define an example analysis to apply some measures of interest (here, computing the mean and the variance) across samples of simulations of powerlaw data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the measures to apply to the simulated signals</span>
<span class="n">measures</span> <span class="o">=</span> <span class="p">{</span><span class="n">np</span><span class="o">.</span><span class="n">var</span> <span class="p">:</span> <span class="p">{},</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span> <span class="p">:</span> <span class="p">{}}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-simulations-across-variations-in-exponent">
<h3>Run simulations across variations in exponent<a class="headerlink" href="#run-simulations-across-variations-in-exponent" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run comparisons across samples of aperiodic noise</span>
<span class="n">results1</span><span class="p">,</span> <span class="n">all_sim_params1</span> <span class="o">=</span> <span class="n">run_comparisons</span><span class="p">(</span>\
    <span class="n">sim_powerlaw</span><span class="p">,</span> <span class="n">SIM_SAMPLERS</span><span class="p">[</span><span class="s1">&#39;comb_sampler&#39;</span><span class="p">],</span> <span class="n">measures</span><span class="p">,</span> <span class="n">return_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;n_seconds&#39;: 30, &#39;fs&#39;: 250, &#39;components&#39;: {&#39;sim_powerlaw&#39;: {&#39;exponent&#39;: 0.0, &#39;f_range&#39;: (0.5, None)}, &#39;sim_oscillation&#39;: {&#39;freq&#39;: 17}}, &#39;component_variances&#39;: [1, 0.2]}
{&#39;n_seconds&#39;: 30, &#39;fs&#39;: 250, &#39;components&#39;: {&#39;sim_powerlaw&#39;: {&#39;exponent&#39;: -0.4, &#39;f_range&#39;: (0.5, None)}, &#39;sim_oscillation&#39;: {&#39;freq&#39;: 35}}, &#39;component_variances&#39;: [1, 1.0]}
{&#39;n_seconds&#39;: 30, &#39;fs&#39;: 250, &#39;components&#39;: {&#39;sim_powerlaw&#39;: {&#39;exponent&#39;: 0.0, &#39;f_range&#39;: (0.5, None)}, &#39;sim_oscillation&#39;: {&#39;freq&#39;: 13}}, &#39;component_variances&#39;: [1, 0.3]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check output simulation parameters</span>
<span class="n">all_sim_params1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_seconds</th>
      <th>fs</th>
      <th>exponent</th>
      <th>f_range</th>
      <th>freq</th>
      <th>var_ap</th>
      <th>var_pe</th>
      <th>has_osc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>30</td>
      <td>250</td>
      <td>0.0</td>
      <td>(0.5, None)</td>
      <td>17</td>
      <td>1</td>
      <td>0.2</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>250</td>
      <td>-0.4</td>
      <td>(0.5, None)</td>
      <td>35</td>
      <td>1</td>
      <td>1.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>250</td>
      <td>0.0</td>
      <td>(0.5, None)</td>
      <td>13</td>
      <td>1</td>
      <td>0.3</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check output values of computed measures</span>
<span class="n">results1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;var&#39;: array([1., 1., 1.]),
 &#39;mean&#39;: array([-1.5158245e-17, -1.5158245e-17,  0.0000000e+00])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the correlations between output measures</span>
<span class="n">compute_all_corrs</span><span class="p">(</span><span class="n">results1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/tom/opt/anaconda3/envs/apm/lib/python3.9/site-packages/scipy/stats/_stats_py.py:5445: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(stats.ConstantInputWarning(warn_msg))
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;var&#39;: {&#39;mean&#39;: (-1.0, 0.0, (nan, nan))},
 &#39;mean&#39;: {&#39;var&#39;: (-1.0, 0.0, (nan, nan))}}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="run-simulations-across-variations-in-multiple-parameters">
<h3>Run simulations across variations in multiple parameters<a class="headerlink" href="#run-simulations-across-variations-in-multiple-parameters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SIM_SAMPLERS</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run comparisons across samples of aperiodic noise</span>
<span class="n">results2</span><span class="p">,</span> <span class="n">all_sim_params2</span> <span class="o">=</span> <span class="n">run_comparisons</span><span class="p">(</span>\
    <span class="n">sim_combined</span><span class="p">,</span> <span class="n">SIM_SAMPLERS</span><span class="p">[</span><span class="s1">&#39;comb_sampler&#39;</span><span class="p">],</span> <span class="n">measures</span><span class="p">,</span> <span class="n">n_sims</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">return_params</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check output simulation parameters</span>
<span class="n">all_sim_params2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>n_seconds</th>
      <th>fs</th>
      <th>exponent</th>
      <th>f_range</th>
      <th>freq</th>
      <th>var_ap</th>
      <th>var_pe</th>
      <th>has_osc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>30</td>
      <td>250</td>
      <td>-0.3</td>
      <td>(0.5, None)</td>
      <td>5</td>
      <td>1</td>
      <td>0.9</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>250</td>
      <td>-1.2</td>
      <td>(0.5, None)</td>
      <td>34</td>
      <td>1</td>
      <td>0.8</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>250</td>
      <td>-1.2</td>
      <td>(0.5, None)</td>
      <td>13</td>
      <td>1</td>
      <td>0.3</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30</td>
      <td>250</td>
      <td>-1.8</td>
      <td>(0.5, None)</td>
      <td>6</td>
      <td>1</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>30</td>
      <td>250</td>
      <td>-0.5</td>
      <td>(0.5, None)</td>
      <td>17</td>
      <td>1</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check output values of computed measures</span>
<span class="n">results2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;var&#39;: array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1.]),
 &#39;mean&#39;: array([-1.18423789e-18,  1.89478063e-17, -6.63173220e-18, -2.36847579e-18,
         1.87109587e-17,  1.55135164e-17, -1.37371596e-17,  1.24344979e-17,
         1.89478063e-17, -1.04212935e-17, -2.94875235e-17,  1.89478063e-18,
         2.32110627e-17,  1.04212935e-17, -6.15803704e-18, -1.04212935e-17,
         1.70530257e-17, -2.51058433e-17,  3.41060513e-17, -5.56591810e-18,
        -1.13686838e-17, -1.13686838e-17, -9.47390314e-18,  1.13686838e-17,
        -1.20792265e-17])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the correlations between output measures</span>
<span class="n">compute_all_corrs</span><span class="p">(</span><span class="n">results2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;var&#39;: {&#39;mean&#39;: (-0.20234118532764883,
   0.33204969861238676,
   (-0.5257729651646598, 0.15932259740004787))},
 &#39;mean&#39;: {&#39;var&#39;: (-0.20234118532764883,
   0.33204969861238676,
   (-0.5257729651646598, 0.15932259740004787))}}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluating-results">
<h3>Evaluating Results<a class="headerlink" href="#evaluating-results" title="Permalink to this headline">¶</a></h3>
<p>After computing the measures, we can examine the results, comparing between different measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Collect colors for each value based on presence of an oscillation</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;COMB&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">osc</span> <span class="k">else</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;AP&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">osc</span> <span class="ow">in</span> <span class="n">all_sim_params2</span><span class="o">.</span><span class="n">has_osc</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the computed measures against each other</span>
<span class="n">plot_dots</span><span class="p">(</span><span class="n">results2</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">],</span> <span class="n">results2</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14-SimulationComparisons_46_0.png" src="../_images/14-SimulationComparisons_46_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="13-SimulationTests.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Simulation Tests</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="15-PowerSpectrumSimulations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Power Spectrum Simulations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Thomas Donoghue<br/>
    
        &copy; Copyright 2021-.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>