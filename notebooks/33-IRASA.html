
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IRASA &#8212; Aperiodic  Methods</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >let toggleHintShow = 'Click to show';</script>
    <script >let toggleHintHide = 'Click to hide';</script>
    <script >let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exponent Comparisons" href="34-ExponentComparisons.html" />
    <link rel="prev" title="Spectral Fitting" href="31-SpectralFitting.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Aperiodic  Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00-Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01-Outline.html">
   Outline
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Simulations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="10-Simulations.html">
   Simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11-TimeDomainSimulations.html">
   Time Series Simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-TimeSimsParameters.html">
   Time Domain Simulation Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-SimulationTests.html">
   Simulation Tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14-SimulationComparisons.html">
   Simulation Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-PowerSpectrumSimulations.html">
   Power Spectrum Simulations
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Time Domain Method Evaluations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="20-TimeDomainMethods.html">
   Time Domain Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="21-AutoCorrelation.html">
   AutoCorrelation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22-Fluctuations.html">
   Fluctuation Analyses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="22B-Fluctuations-Multiscale.html">
   Fluctuations (Multiscale)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="23-FractalDimension.html">
   Fractal Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="23B-Fractal-State.html">
   Fractal Dimension (State Space)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="24-Complexity.html">
   Complexity Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="24B-Complexity-State.html">
   Complexity (State Space)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="25-Entropy.html">
   Information Metrics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="25B-Entropy-Multiscale.html">
   Multiscale Entropy
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Spectral Method Evaluations
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="30-SpectralMethods.html">
   Spectral Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="31-SpectralFitting.html">
   Spectral Fitting
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   IRASA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="34-ExponentComparisons.html">
   Exponent Comparisons
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Method Comparisons
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="40-MethodComparisons.html">
   Method Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="41-WithinComparisons.html">
   Within Method Type Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="42-BetweenComparisons.html">
   Between Method Type Comparisons
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="50-DataComparisons.html">
   Data Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="51-RestingEEGData.html">
   Resting EEG Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="52-DevelopmentalEEGData.html">
   Developmental EEG Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="53-iEEGData.html">
   iEEG Data
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/33-IRASA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/aperiodicmethods//master?urlpath=tree/apmethods/notebooks/33-IRASA.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#settings">
   Settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   IRASA
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#irasa-on-example-signals">
     IRASA on Example Signals
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#powerlaw-signal">
       Powerlaw Signal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combined-signal">
       Combined Signal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#knee-signal">
       Knee Signal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#peak-bandwidth">
       Peak Bandwidth
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#irasa-simulation-tests">
   IRASA Simulation Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulations-aperiodic-variations">
     Simulations: Aperiodic Variations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aperiodic-exponent">
       Aperiodic Exponent
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aperiodic-exponent-combined-signal">
       Aperiodic Exponent (combined signal)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualize-results">
       Visualize Results
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulations-periodic-variations">
     Simulations: Periodic Variations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oscillation-frequency">
       Oscillation Frequency
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oscillation-power">
       Oscillation Power
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Visualize Results
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulations-knee-variations">
   Simulations: Knee Variations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#without-knee-fit">
     Without Knee Fit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#with-knee-fit">
     With Knee Fit
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   Simulations: Periodic Variations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Peak Bandwidth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#burst-probability">
     Burst Probability
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusions">
   Conclusions
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>IRASA</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#settings">
   Settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   IRASA
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#irasa-on-example-signals">
     IRASA on Example Signals
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#powerlaw-signal">
       Powerlaw Signal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combined-signal">
       Combined Signal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#knee-signal">
       Knee Signal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#peak-bandwidth">
       Peak Bandwidth
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#irasa-simulation-tests">
   IRASA Simulation Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulations-aperiodic-variations">
     Simulations: Aperiodic Variations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aperiodic-exponent">
       Aperiodic Exponent
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aperiodic-exponent-combined-signal">
       Aperiodic Exponent (combined signal)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualize-results">
       Visualize Results
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulations-periodic-variations">
     Simulations: Periodic Variations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oscillation-frequency">
       Oscillation Frequency
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oscillation-power">
       Oscillation Power
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Visualize Results
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulations-knee-variations">
   Simulations: Knee Variations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#without-knee-fit">
     Without Knee Fit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#with-knee-fit">
     With Knee Fit
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   Simulations: Periodic Variations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Peak Bandwidth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#burst-probability">
     Burst Probability
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusions">
   Conclusions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="irasa">
<h1>IRASA<a class="headerlink" href="#irasa" title="Permalink to this headline">¶</a></h1>
<p>This notebook measures aperiodic activity using the ‘irregular resampling auto-spectral analysis’ (IRASA) algorithm.</p>
<p>IRASA does not explicitly consider signals with a knee, nor does it consider signals where there are central frequencies with some variance around them as in the setting of FOOOF.</p>
<p>The purpose of this notebook is to test the robustness of IRASA to these deviations and to quantify the error in estimating <span class="math notranslate nohighlight">\(\chi\)</span> as we test IRASA on various signals whose power spectrum deviates from a strict <span class="math notranslate nohighlight">\(1/f\)</span> structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">neurodsp.sim</span> <span class="kn">import</span> <span class="n">sim_powerlaw</span><span class="p">,</span> <span class="n">sim_synaptic_current</span><span class="p">,</span> <span class="n">sim_combined</span>
<span class="kn">from</span> <span class="nn">neurodsp.spectral</span> <span class="kn">import</span> <span class="n">compute_spectrum</span>
<span class="kn">from</span> <span class="nn">neurodsp.aperiodic</span> <span class="kn">import</span> <span class="n">compute_irasa</span><span class="p">,</span> <span class="n">fit_irasa</span>
<span class="kn">from</span> <span class="nn">neurodsp.utils</span> <span class="kn">import</span> <span class="n">set_random_seed</span>

<span class="kn">from</span> <span class="nn">fooof.plts</span> <span class="kn">import</span> <span class="n">plot_spectra</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/59/8y2d5r257c77vzymnqs47x080000gn/T/ipykernel_16054/3211052454.py:8: DeprecationWarning: 
The `fooof` package is being deprecated and replaced by the `specparam` (spectral parameterization) package.
This version of `fooof` (1.1) is fully functional, but will not be further updated.
New projects are recommended to update to using `specparam` (see Changelog for details).
  from fooof.plts import plot_spectra
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import custom code</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span> <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>

<span class="kn">from</span> <span class="nn">apm.io</span> <span class="kn">import</span> <span class="n">APMDB</span>
<span class="kn">from</span> <span class="nn">apm.run</span> <span class="kn">import</span> <span class="n">run_sims</span><span class="p">,</span> <span class="n">run_sims_load</span>
<span class="kn">from</span> <span class="nn">apm.methods</span> <span class="kn">import</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">fit_irasa_knee</span>
<span class="kn">from</span> <span class="nn">apm.methods.settings</span> <span class="kn">import</span> <span class="n">IRASA_PARAMS</span><span class="p">,</span> <span class="n">IRASA_PARAMS_KNEE</span><span class="p">,</span> <span class="n">FIT_F_RANGE</span><span class="p">,</span> <span class="n">FIT_F_RANGE_LONG</span>
<span class="kn">from</span> <span class="nn">apm.plts.sims</span> <span class="kn">import</span> <span class="n">plot_sims</span><span class="p">,</span> <span class="n">plot_ap_sims</span><span class="p">,</span> <span class="n">plot_pe_sims</span>
<span class="kn">from</span> <span class="nn">apm.plts.utils</span> <span class="kn">import</span> <span class="n">figsaver</span>
<span class="kn">from</span> <span class="nn">apm.plts.settings</span> <span class="kn">import</span> <span class="n">COLORS</span>
<span class="kn">from</span> <span class="nn">apm.sim.examples</span> <span class="kn">import</span> <span class="n">get_examples</span>
<span class="kn">from</span> <span class="nn">apm.sim.settings</span> <span class="kn">import</span> <span class="n">N_SIMS</span>
<span class="kn">from</span> <span class="nn">apm.sim.settings</span> <span class="kn">import</span> <span class="n">FS2</span> <span class="k">as</span> <span class="n">FS</span>
<span class="kn">from</span> <span class="nn">apm.sim.defs</span> <span class="kn">import</span> <span class="n">SIM_ITERS</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set plot style</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="settings">
<h2>Settings<a class="headerlink" href="#settings" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Update sampling frequency for simulation definition</span>
<span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">update_base</span><span class="p">(</span><span class="n">fs</span><span class="o">=</span><span class="n">FS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set data specific settings</span>
<span class="n">IRASA_PARAMS</span><span class="p">[</span><span class="s1">&#39;fs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FS</span>
<span class="n">IRASA_PARAMS_KNEE</span><span class="p">[</span><span class="s1">&#39;fs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FS</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot settings</span>
<span class="n">PSD_PLT_KWARGS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;log_freqs&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;log_powers&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;colors&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span>
    <span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">],</span>
    <span class="s1">&#39;labels&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Full PSD&#39;</span><span class="p">,</span> <span class="s1">&#39;PSD-AP&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for saving figures</span>
<span class="n">SAVE_FIG</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">FIGPATH</span> <span class="o">=</span> <span class="n">APMDB</span><span class="p">()</span><span class="o">.</span><span class="n">figs_path</span> <span class="o">/</span> <span class="s1">&#39;33_irasa&#39;</span>

<span class="c1"># Create helper function to manage figsaver settings</span>
<span class="n">fsaver</span> <span class="o">=</span> <span class="n">figsaver</span><span class="p">(</span><span class="n">SAVE_FIG</span><span class="p">,</span> <span class="n">FIGPATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for loading simulations</span>
<span class="n">SIMPATH</span> <span class="o">=</span> <span class="n">APMDB</span><span class="p">()</span><span class="o">.</span><span class="n">sims_path</span> <span class="o">/</span> <span class="s1">&#39;time_series&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define structure for precomputed simulation file name</span>
<span class="n">sim_file</span> <span class="o">=</span> <span class="s1">&#39;ts_sims_</span><span class="si">{}</span><span class="s1">_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the random seed</span>
<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define collection of example signals</span>
<span class="n">examples</span> <span class="o">=</span> <span class="n">get_examples</span><span class="p">(</span><span class="n">fs</span><span class="o">=</span><span class="n">FS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>IRASA<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>IRASA stands for irregularly resampled auto-spectral analysis. It seeks to dissociate aperiodic and periodic components of the signal, under the assumption that there is a 1/f aperiodic component, with overlying periodic (rhythmic) activity. IRASA computes the aperiodic component by appealing to the self-similar nature of signals whose power spectrum obeys a power law. By resampling the time series at non-integer rates, the peaks in the power spectrum (corresponding to periodic components) will be shifted in frequency by a quantity proportional to the resampling rate. However, self-similarity of the aperiodic component ensures that the power law decay remains the same across resamplings. The periodic activity can then be averaged out across the power spectra of the resampled time series.</p>
<p>Note that IRASA requires the time series data (as this is what is resampled).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the IRASA settings</span>
<span class="nb">print</span><span class="p">(</span><span class="n">IRASA_PARAMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;fs&#39;: 500, &#39;f_range&#39;: (1, 50)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the IRASA settings - knee</span>
<span class="n">IRASA_PARAMS_KNEE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;fs&#39;: 500, &#39;f_range&#39;: (1, 50), &#39;fit_func&#39;: &#39;fit_irasa_knee&#39;}
</pre></div>
</div>
</div>
</div>
<div class="section" id="irasa-on-example-signals">
<h3>IRASA on Example Signals<a class="headerlink" href="#irasa-on-example-signals" title="Permalink to this headline">¶</a></h3>
<div class="section" id="powerlaw-signal">
<h4>Powerlaw Signal<a class="headerlink" href="#powerlaw-signal" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate IRASA and fit exponent</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">,</span> <span class="n">psd_pe</span> <span class="o">=</span> <span class="n">compute_irasa</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;powerlaw&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">IRASA_PARAMS</span><span class="p">)</span>
<span class="n">fit_off</span><span class="p">,</span> <span class="n">fit_exp</span> <span class="o">=</span> <span class="n">fit_irasa</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the full power spectrum</span>
<span class="n">freqs_full</span><span class="p">,</span> <span class="n">psd_full</span> <span class="o">=</span> <span class="n">compute_spectrum</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;powerlaw&#39;</span><span class="p">],</span> <span class="n">FS</span><span class="p">,</span> <span class="n">f_range</span><span class="o">=</span><span class="n">FIT_F_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the full spectrum the IRASA separate aperiodic component</span>
<span class="n">plot_spectra</span><span class="p">([</span><span class="n">freqs_full</span><span class="p">,</span> <span class="n">freqs</span><span class="p">],</span> <span class="p">[</span><span class="n">psd_full</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">],</span>
             <span class="o">**</span><span class="n">PSD_PLT_KWARGS</span><span class="p">,</span> <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_example_ap&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_21_0.png" src="../_images/33-IRASA_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the calculated value against ground truth</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured Exponent:</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fit_exp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Expected Exponent:</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ap&#39;</span><span class="p">][</span><span class="s1">&#39;exponent&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Measured Exponent:	 -1.0019
Expected Exponent:	 -1.0000
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="combined-signal">
<h4>Combined Signal<a class="headerlink" href="#combined-signal" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate IRASA and fit exponent</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">,</span> <span class="n">psd_pe</span> <span class="o">=</span> <span class="n">compute_irasa</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;combined&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">IRASA_PARAMS</span><span class="p">)</span>
<span class="n">fit_off</span><span class="p">,</span> <span class="n">fit_exp</span>  <span class="o">=</span> <span class="n">fit_irasa</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the full power spectrum</span>
<span class="n">freqs_full</span><span class="p">,</span> <span class="n">psd_full</span> <span class="o">=</span> <span class="n">compute_spectrum</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;combined&#39;</span><span class="p">],</span> <span class="n">FS</span><span class="p">,</span> <span class="n">f_range</span><span class="o">=</span><span class="n">FIT_F_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the full spectrum the IRASA separate aperiodic component</span>
<span class="n">plot_spectra</span><span class="p">([</span><span class="n">freqs_full</span><span class="p">,</span> <span class="n">freqs</span><span class="p">],</span> <span class="p">[</span><span class="n">psd_full</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">],</span>
             <span class="o">**</span><span class="n">PSD_PLT_KWARGS</span><span class="p">,</span> <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_example_pe&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_26_0.png" src="../_images/33-IRASA_26_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the calculated value against ground truth</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured Exponent:</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fit_exp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Expected Exponent:</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ap&#39;</span><span class="p">][</span><span class="s1">&#39;exponent&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Measured Exponent:	 -0.9992
Expected Exponent:	 -1.0000
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="knee-signal">
<h4>Knee Signal<a class="headerlink" href="#knee-signal" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate IRASA and fit exponent</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">,</span> <span class="n">psd_pe</span> <span class="o">=</span> <span class="n">compute_irasa</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;synaptic&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">IRASA_PARAMS</span><span class="p">)</span>
<span class="n">fit_off</span><span class="p">,</span> <span class="n">fit_exp</span>  <span class="o">=</span> <span class="n">fit_irasa</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">)</span>
<span class="n">fit_kn_off</span><span class="p">,</span> <span class="n">fit_kn_knee</span><span class="p">,</span> <span class="n">fit_kn_exp</span> <span class="o">=</span> <span class="n">fit_irasa_knee</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the full power spectrum</span>
<span class="n">freqs_full</span><span class="p">,</span> <span class="n">psd_full</span> <span class="o">=</span> <span class="n">compute_spectrum</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;synaptic&#39;</span><span class="p">],</span> <span class="n">FS</span><span class="p">,</span> <span class="n">f_range</span><span class="o">=</span><span class="n">FIT_F_RANGE_LONG</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the full spectrum the IRASA separate aperiodic component</span>
<span class="n">plot_spectra</span><span class="p">([</span><span class="n">freqs_full</span><span class="p">,</span> <span class="n">freqs</span><span class="p">],</span> <span class="p">[</span><span class="n">psd_full</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">],</span> <span class="o">**</span><span class="n">PSD_PLT_KWARGS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_31_0.png" src="../_images/33-IRASA_31_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the calculated value against ground truth</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured Exponent (fixed):</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fit_exp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured Exponent (knee):</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fit_kn_exp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Expected Exponent:</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Measured Exponent (fixed):	 -0.8061
Measured Exponent (knee):	 -1.8772
Expected Exponent:		 -2.0000
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="peak-bandwidth">
<h4>Peak Bandwidth<a class="headerlink" href="#peak-bandwidth" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate IRASA and fit exponent</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">,</span> <span class="n">psd_pe</span> <span class="o">=</span> <span class="n">compute_irasa</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;comb_peak&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">IRASA_PARAMS</span><span class="p">)</span>
<span class="n">fit_off</span><span class="p">,</span> <span class="n">fit_exp</span>  <span class="o">=</span> <span class="n">fit_irasa</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the full power spectrum</span>
<span class="n">freqs_full</span><span class="p">,</span> <span class="n">psd_full</span> <span class="o">=</span> <span class="n">compute_spectrum</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s1">&#39;comb_peak&#39;</span><span class="p">],</span> <span class="n">FS</span><span class="p">,</span> <span class="n">f_range</span><span class="o">=</span><span class="n">FIT_F_RANGE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare the full spectrum the IRASA separate aperiodic component</span>
<span class="n">plot_spectra</span><span class="p">([</span><span class="n">freqs_full</span><span class="p">,</span> <span class="n">freqs</span><span class="p">],</span> <span class="p">[</span><span class="n">psd_full</span><span class="p">,</span> <span class="n">psd_ap</span><span class="p">],</span> <span class="o">**</span><span class="n">PSD_PLT_KWARGS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_36_0.png" src="../_images/33-IRASA_36_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the calculated value against ground truth</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured Exponent:</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fit_exp</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Expected Exponent:</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ap&#39;</span><span class="p">][</span><span class="s1">&#39;exponent&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Measured Exponent:	 -1.1160
Expected Exponent:	 -1.0000
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="irasa-simulation-tests">
<h2>IRASA Simulation Tests<a class="headerlink" href="#irasa-simulation-tests" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simulations-aperiodic-variations">
<h3>Simulations: Aperiodic Variations<a class="headerlink" href="#simulations-aperiodic-variations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="aperiodic-exponent">
<h4>Aperiodic Exponent<a class="headerlink" href="#aperiodic-exponent" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a set of simulations, calculating IRASA estimation across exponents</span>
<span class="n">ir_sims_exp</span> <span class="o">=</span> <span class="n">run_sims</span><span class="p">(</span><span class="n">sim_powerlaw</span><span class="p">,</span> <span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;ap_exp&#39;</span><span class="p">],</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="aperiodic-exponent-combined-signal">
<h4>Aperiodic Exponent (combined signal)<a class="headerlink" href="#aperiodic-exponent-combined-signal" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a set of simulations, calculating IRASA estimation across exponents, with an oscillation</span>
<span class="n">ir_sims_comb</span> <span class="o">=</span> <span class="n">run_sims</span><span class="p">(</span><span class="n">sim_combined</span><span class="p">,</span> <span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;comb_exp&#39;</span><span class="p">],</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualize-results">
<h4>Visualize Results<a class="headerlink" href="#visualize-results" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot IRASA estimation across exponents, both with and without oscillation</span>
<span class="n">plot_ap_sims</span><span class="p">(</span><span class="n">ir_sims_exp</span><span class="p">,</span> <span class="n">ir_sims_comb</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (IR)&#39;</span><span class="p">,</span>
             <span class="n">expected</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;ap_exp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_ap&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_45_0.png" src="../_images/33-IRASA_45_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="simulations-periodic-variations">
<h3>Simulations: Periodic Variations<a class="headerlink" href="#simulations-periodic-variations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="oscillation-frequency">
<h4>Oscillation Frequency<a class="headerlink" href="#oscillation-frequency" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a set of simulations, calculating IRASA across oscillation frequencies</span>
<span class="n">ir_sims_freq</span> <span class="o">=</span> <span class="n">run_sims</span><span class="p">(</span><span class="n">sim_combined</span><span class="p">,</span> <span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;osc_freq&#39;</span><span class="p">],</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="oscillation-power">
<h4>Oscillation Power<a class="headerlink" href="#oscillation-power" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a set of simulations, calculating IRASA across oscillation power</span>
<span class="n">ir_sims_pow</span> <span class="o">=</span> <span class="n">run_sims</span><span class="p">(</span><span class="n">sim_combined</span><span class="p">,</span> <span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;osc_pow&#39;</span><span class="p">],</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h4>Visualize Results<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot effect of oscillation variation on estimated exponent</span>
<span class="n">plot_pe_sims</span><span class="p">(</span><span class="n">ir_sims_freq</span><span class="p">,</span> <span class="n">ir_sims_pow</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (IR)&#39;</span><span class="p">,</span>
             <span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;osc_freq&#39;</span><span class="p">]),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">],</span>
             <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_pe&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_52_0.png" src="../_images/33-IRASA_52_0.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="simulations-knee-variations">
<h2>Simulations: Knee Variations<a class="headerlink" href="#simulations-knee-variations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="without-knee-fit">
<h3>Without Knee Fit<a class="headerlink" href="#without-knee-fit" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a set of simulations, calculating IRASA estimation across different timescales</span>
<span class="n">ir_sims_tscales_lin</span> <span class="o">=</span> <span class="n">run_sims</span><span class="p">(</span><span class="n">sim_synaptic_current</span><span class="p">,</span> <span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;syn_tscales&#39;</span><span class="p">],</span>
                               <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the estimated exponent across different timescales (estimated without a knee)</span>
<span class="n">plot_sims</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;syn_tscales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ir_sims_tscales_lin</span><span class="p">,</span>
          <span class="s1">&#39;Timescale&#39;</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (IR)&#39;</span><span class="p">,</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;KN&#39;</span><span class="p">],</span>
          <span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;syn_tscales&#39;</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Knee Sims (fit w/out Knee)&#39;</span><span class="p">,</span>
          <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_tscales_lin&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_56_0.png" src="../_images/33-IRASA_56_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run simulations calculating irasa exponent across knee parameters (sims from file)</span>
<span class="n">ir_sims_knee_lin</span> <span class="o">=</span> <span class="n">run_sims_load</span><span class="p">(</span><span class="n">SIMPATH</span> <span class="o">/</span> <span class="n">sim_file</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;ap_knee&#39;</span><span class="p">),</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the estimated exponent across different timescales (estimated without a knee)</span>
<span class="n">plot_sims</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;kn_knee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ir_sims_knee_lin</span><span class="p">,</span> 
          <span class="s1">&#39;Knee Parameter&#39;</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (IR)&#39;</span><span class="p">,</span> <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;KN&#39;</span><span class="p">],</span>
          <span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;kn_knee&#39;</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Knee Sims (fit w/out Knee)&#39;</span><span class="p">,</span>
          <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_knee_lin&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_58_0.png" src="../_images/33-IRASA_58_0.png" />
</div>
</div>
</div>
<div class="section" id="with-knee-fit">
<h3>With Knee Fit<a class="headerlink" href="#with-knee-fit" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a set of simulations, calculating IRASA estimation across different timescales</span>
<span class="n">ir_sims_knee</span> <span class="o">=</span> <span class="n">run_sims</span><span class="p">(</span><span class="n">sim_synaptic_current</span><span class="p">,</span> <span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;syn_tscales&#39;</span><span class="p">],</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS_KNEE</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the estimated exponent across different timescales (estimated with a knee)</span>
<span class="n">plot_sims</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;syn_tscales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ir_sims_knee</span><span class="p">,</span> <span class="s1">&#39;Timescale&#39;</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (IR)&#39;</span><span class="p">,</span>
          <span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;KN&#39;</span><span class="p">],</span> <span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;syn_tscales&#39;</span><span class="p">]),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.65</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">],</span>
          <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_tscales&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_61_0.png" src="../_images/33-IRASA_61_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run simulations calculating irasa exponent across knee parameters (sims from file)</span>
<span class="n">ir_sims_knee</span> <span class="o">=</span> <span class="n">run_sims_load</span><span class="p">(</span><span class="n">SIMPATH</span> <span class="o">/</span> <span class="n">sim_file</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;ap_knee&#39;</span><span class="p">),</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS_KNEE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the estimated exponent across different timescales (estimated with a knee)</span>
<span class="n">plot_sims</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;kn_knee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ir_sims_knee</span><span class="p">,</span>
          <span class="s1">&#39;Knee Parameter&#39;</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (SP)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;KN&#39;</span><span class="p">],</span>
          <span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;kn_knee&#39;</span><span class="p">]),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">],</span>
          <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_knee&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_63_0.png" src="../_images/33-IRASA_63_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>Simulations: Periodic Variations<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>Peak Bandwidth<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run a set of simulations, calculating IRASA estimate across peak bandwidth (sims from file)</span>
<span class="n">ir_sims_bw</span> <span class="o">=</span> <span class="n">run_sims_load</span><span class="p">(</span><span class="n">SIMPATH</span> <span class="o">/</span> <span class="n">sim_file</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;comb_bw&#39;</span><span class="p">),</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the estimated exponent across different peak bandwidths</span>
<span class="n">plot_sims</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;peak_bw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ir_sims_bw</span><span class="p">,</span> <span class="s1">&#39;Bandwidth&#39;</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (IR)&#39;</span><span class="p">,</span>
          <span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;peak_bw&#39;</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;BW&#39;</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
          <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_bw&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_67_0.png" src="../_images/33-IRASA_67_0.png" />
</div>
</div>
</div>
<div class="section" id="burst-probability">
<h3>Burst Probability<a class="headerlink" href="#burst-probability" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run simulations calculating specparam exponent across burst probabilities</span>
<span class="n">ir_sims_burst</span> <span class="o">=</span> <span class="n">run_sims</span><span class="p">(</span><span class="n">sim_combined</span><span class="p">,</span> <span class="n">SIM_ITERS</span><span class="p">[</span><span class="s1">&#39;comb_burst&#39;</span><span class="p">],</span> <span class="n">irasa</span><span class="p">,</span> <span class="n">IRASA_PARAMS</span><span class="p">,</span> <span class="n">N_SIMS</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the estimated exponent across peak bandwidths</span>
<span class="n">plot_sims</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">iters</span><span class="p">[</span><span class="s1">&#39;comb_burst&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ir_sims_burst</span><span class="p">,</span>
          <span class="s1">&#39;Burst Probability&#39;</span><span class="p">,</span> <span class="s1">&#39;Measured Exponent (SP)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLORS</span><span class="p">[</span><span class="s1">&#39;BW&#39;</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">],</span>
          <span class="n">expected</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;ap&#39;</span><span class="p">][</span><span class="s1">&#39;exponent&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">SIM_ITERS</span><span class="o">.</span><span class="n">iters</span><span class="p">[</span><span class="s1">&#39;comb_burst&#39;</span><span class="p">]),</span>
          <span class="o">**</span><span class="n">fsaver</span><span class="p">(</span><span class="s1">&#39;ir_burst&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/33-IRASA_70_0.png" src="../_images/33-IRASA_70_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<p>Overall, we can see the following patterns in these simulations:</p>
<ul class="simple">
<li><p>IRASA is highly accurate at estimating aperiodic exponent in the case of true 1/f data</p></li>
<li><p>IRASA exponent estimations are robust to variations in oscillation frequency and power (with true 1/f)</p></li>
<li><p>IRASA is less robust (less accurate) at estimating the aperiodic exponent when there is an aperiodic knee</p></li>
<li><p>IRASA has difficulty isolating and estimating aperiodic activity when there are are high bandwidth peaks</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="31-SpectralFitting.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Spectral Fitting</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="34-ExponentComparisons.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exponent Comparisons</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Thomas Donoghue<br/>
    
        &copy; Copyright 2021-.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>